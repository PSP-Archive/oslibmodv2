<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>Virtual Files</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__virtualfile.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#groups">Modules</a> &#124;
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Virtual Files</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group__virtualfile__io"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__virtualfile__io.html">I/O routines</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__virtualfile__sources"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__virtualfile__sources.html">Virtual file sources</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__virtualfile__ram"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__virtualfile__ram.html">RAM virtual files</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e.html">VIRTUAL_FILE</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e___s_o_u_r_c_e.html">VIRTUAL_FILE_SOURCE</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_o_s_l___v_i_r_t_u_a_l_f_i_l_e_n_a_m_e.html">OSL_VIRTUALFILENAME</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga2e7ccec76b09ff3f2d925f60050b5fcb"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__virtualfile.html#ga2e7ccec76b09ff3f2d925f60050b5fcb">VF_OPEN_MODES</a> { <a class="el" href="group__virtualfile.html#gga2e7ccec76b09ff3f2d925f60050b5fcba2e020641b63339f59df52a0c2d4d3a02">VF_O_READ</a>, 
<a class="el" href="group__virtualfile.html#gga2e7ccec76b09ff3f2d925f60050b5fcbadf9ddacf8fe982cb181d2937fd35f4ec">VF_O_READWRITE</a>, 
<a class="el" href="group__virtualfile.html#gga2e7ccec76b09ff3f2d925f60050b5fcbab0b2f6caaeec6ee61c08f33a74c7c589">VF_O_WRITE</a>
 }</td></tr>
<tr class="separator:ga2e7ccec76b09ff3f2d925f60050b5fcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaa547c677ff6bf88640719a647cd02584"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__virtualfile.html#gaa547c677ff6bf88640719a647cd02584">VirtualFileInit</a> ()</td></tr>
<tr class="separator:gaa547c677ff6bf88640719a647cd02584"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga07077224dae9a3b273e364c1167f7908"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e.html">VIRTUAL_FILE</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__virtualfile.html#ga07077224dae9a3b273e364c1167f7908">VirtualFileOpen</a> (void *param1, int param2, int type, int mode)</td></tr>
<tr class="separator:ga07077224dae9a3b273e364c1167f7908"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga22020f913566390f6578dfccefdf7219"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__virtualfile.html#ga22020f913566390f6578dfccefdf7219">VirtualFileClose</a> (<a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e.html">VIRTUAL_FILE</a> *f)</td></tr>
<tr class="separator:ga22020f913566390f6578dfccefdf7219"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0181b5d9f972777de7a959a47403ffb5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__virtualfile.html#ga0181b5d9f972777de7a959a47403ffb5">VirtualFileRegisterSource</a> (<a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e___s_o_u_r_c_e.html">VIRTUAL_FILE_SOURCE</a> *vfs)</td></tr>
<tr class="separator:ga0181b5d9f972777de7a959a47403ffb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6f7804ec2206cf7b3de11a951f82763c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_o_s_l___v_i_r_t_u_a_l_f_i_l_e_n_a_m_e.html">OSL_VIRTUALFILENAME</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__virtualfile.html#ga6f7804ec2206cf7b3de11a951f82763c">oslFindFileInVirtualFilenameList</a> (const char *fname, int type)</td></tr>
<tr class="separator:ga6f7804ec2206cf7b3de11a951f82763c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga81e5e0ef4b85e053188625c88b32c5a1"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__virtualfile.html#ga81e5e0ef4b85e053188625c88b32c5a1">oslReadEntireFileToMemory</a> (<a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e.html">VIRTUAL_FILE</a> *f, int *size)</td></tr>
<tr class="separator:ga81e5e0ef4b85e053188625c88b32c5a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Virtual File support for OSLib. This API is meant to be an universal mean to manipulate every file source possible as you can define your own. </p>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="ga2e7ccec76b09ff3f2d925f60050b5fcb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__virtualfile.html#ga2e7ccec76b09ff3f2d925f60050b5fcb">VF_OPEN_MODES</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Enumeration describing the available file open modes. Please note that some sources do not support some modes like READWRITE or WRITE, in this case they'll fail when an attempt to open a file in one of these modes is made. The resulting file returned by VirtualFileOpen will be NULL. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="gga2e7ccec76b09ff3f2d925f60050b5fcba2e020641b63339f59df52a0c2d4d3a02"></a>VF_O_READ&#160;</td><td class="fielddoc">
<p>Read only. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga2e7ccec76b09ff3f2d925f60050b5fcbadf9ddacf8fe982cb181d2937fd35f4ec"></a>VF_O_READWRITE&#160;</td><td class="fielddoc">
<p>Read &amp; Write. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga2e7ccec76b09ff3f2d925f60050b5fcbab0b2f6caaeec6ee61c08f33a74c7c589"></a>VF_O_WRITE&#160;</td><td class="fielddoc">
<p>Write only. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gaa547c677ff6bf88640719a647cd02584"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VirtualFileInit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initializes the virtual filesystem. Done by default by OSLib, so there is no need to call it by yourself. </p>

</div>
</div>
<a class="anchor" id="ga07077224dae9a3b273e364c1167f7908"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e.html">VIRTUAL_FILE</a>* VirtualFileOpen </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>param1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>param2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Open a new file. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">param1</td><td>Pointer to a string representing the file name. </td></tr>
    <tr><td class="paramname">param2</td><td>Should always be 0 </td></tr>
    <tr><td class="paramname">type</td><td>File type. By default, can be:<ul>
<li>VF_MEMORY: read/write from a memory block</li>
<li>VF_FILE: read from standard stdio routines. </li>
</ul>
</td></tr>
    <tr><td class="paramname">mode</td><td>One of VF_OPEN_MODES. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga22020f913566390f6578dfccefdf7219"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int VirtualFileClose </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e.html">VIRTUAL_FILE</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Closes an open file. </p>

</div>
</div>
<a class="anchor" id="ga0181b5d9f972777de7a959a47403ffb5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int VirtualFileRegisterSource </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e___s_o_u_r_c_e.html">VIRTUAL_FILE_SOURCE</a> *&#160;</td>
          <td class="paramname"><em>vfs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adds a new file source to the virtual file system. </p><pre class="fragment">\param vfs
    Must be a pointer to a valid VIRTUAL_FILE_SOURCE interface containing all your functions for handling the file source.
\return
    Returns the identifier of your source or -1 if it has failed. You can then use this ID as a file type (parameter for VirtualFileOpen).  </pre> 
</div>
</div>
<a class="anchor" id="ga6f7804ec2206cf7b3de11a951f82763c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_o_s_l___v_i_r_t_u_a_l_f_i_l_e_n_a_m_e.html">OSL_VIRTUALFILENAME</a>* oslFindFileInVirtualFilenameList </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Call this function in your virtual file source OPEN handler, if it's a RAM based device and param2 == 0 (means null size, impossible). It will return a UL_VIRTUALFILENAME where you can get a pointer to the data and their size. Note that the return value can be NULL if the file has not been found or an error occured (e.g. fname is NULL). </p>

</div>
</div>
<a class="anchor" id="ga81e5e0ef4b85e053188625c88b32c5a1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* oslReadEntireFileToMemory </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e.html">VIRTUAL_FILE</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reads an entire file to memory and returns a pointer to the memory block. The block memory usage is stepped by 4 kB, so even a 1 kB file will take 16 kB, so this function is not recommended for opening a lot of small files. The bloc must be freed (using free) once you've finished with it! </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>Pointer to an open virtual file. </td></tr>
    <tr><td class="paramname">size</td><td>Pointer to an integer that will contain the number of bytes read from the file. Can be NULL (in this case the value is discarded).</td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> size;</div>
<div class="line"><a class="code" href="struct_v_i_r_t_u_a_l___f_i_l_e.html">VIRTUAL_FILE</a> *f;</div>
<div class="line"><span class="keywordtype">char</span> *data;</div>
<div class="line"><span class="comment">//Open a file</span></div>
<div class="line">f = <a class="code" href="group__virtualfile.html#ga07077224dae9a3b273e364c1167f7908">VirtualFileOpen</a>(<span class="stringliteral">&quot;test.txt&quot;</span>, 0, <a class="code" href="group__virtualfile__sources.html#ga1520dc89d51af85e1bd24e5377eff162">VF_AUTO</a>, <a class="code" href="group__virtualfile.html#gga2e7ccec76b09ff3f2d925f60050b5fcba2e020641b63339f59df52a0c2d4d3a02">VF_O_READ</a>);</div>
<div class="line"><span class="comment">//Read it entirely to RAM</span></div>
<div class="line">data = <a class="code" href="group__virtualfile.html#ga81e5e0ef4b85e053188625c88b32c5a1">oslReadEntireFileToMemory</a>(f, &amp;size);</div>
<div class="line"><span class="comment">//Print each character</span></div>
<div class="line"><span class="keywordflow">for</span> (i=0;i&lt;size;i++)</div>
<div class="line">        <a class="code" href="group__main__debug.html#ga88d2f4d23b2aa2f502329ee6e6b6e048">oslPrintf</a>(<span class="stringliteral">&quot;%c&quot;</span>, data[i]);</div>
</div><!-- fragment --> 
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.7 </li>
  </ul>
</div>
</body>
</html>
